import pandas as pd
from createTable import criarTabelaDividendo
import connectionDatabase as Conn

database = Conn.connectionDB()
cursor = database.cursor()

month = ["01/01/2017", "01/02/2017", "01/03/2017", "01/04/2017", "01/05/2017", "01/06/2017", "01/07/2017", "01/08/2017",
         "01/09/2017", "01/10/2017", "01/11/2017", "01/12/2017", "01/01/2018", "01/02/2018", "01/03/2018", "01/04/2018",
         "01/05/2018", "01/06/2018", "01/07/2018", "01/08/2018", "01/09/2018", "01/10/2018", "01/11/2018", "01/12/2018",
         "01/01/2019", "01/02/2019", "01/03/2019", "01/04/2019", "01/05/2019", "01/06/2019", "01/07/2019", "01/08/2019",
         "01/09/2019", "01/10/2019", "01/11/2019", "01/12/2019", "01/01/2020", "01/02/2020", "01/03/2020", "01/04/2020",
         "01/05/2020", "01/06/2020", "01/07/2020", "01/08/2020", "01/09/2020", "01/10/2020", "01/11/2020", "01/12/2020",
         "01/01/2021", "01/02/2021", "01/03/2021", "01/04/2021", "01/05/2021", "01/06/2021", "01/07/2021", "01/08/2021"]

# BTLG11
# percentYield = [0.832823704159134,0.42904914022737,0.412251179729996,0.391762214433188,0.442719783353394,
# 0.399630362378696,0.55831547029703,0.543555394717206,0.44000366410223,0.439678321311475,0.421529,0.45198708974359,
# 0.422720067686137,0.424051402223345,0.458796219178082,0.468921583333333,0.480394890410959,0.51685616,
# 0.419741829878485,0.49126158387329,0.482175644430558,0.471460901688782,0.46947039295393,0.504352234482759,
# 0.440027100890922,0.403982252595889,0.397801872384937,0.443402608247423,0.445263845271318,0.398974447378641,
# 0.358789368304645,0.381836710813309,0.380418580292992,0.377394093782432,0.36068530207394,0.581690159180457,
# 0.550660792951542,0.609137055837564,0.5420054200542,0.538386992570259,0.468515742128936,0.476190476190476,
# 0.455290475323256,0.312204351939451,0.572573718866304,0.531255533911812,0.566037735849057,0.544464609800363,
# 0.507485409794468,0.526546731022378,0.56199821587868,0.619359405414971,0.619249823071479,0.612155662439878,
# 0.670532801739761,0.68265857589836]

# BRCR11
# percentYield = [0.790250230871979,0.656333717554907,0.624136457234092,0.564916771733372,0.407075256371108,
# 0.373606606503574,0.338026803344018,0.429772495287519,0.415752741826537,0.471153846153846,0.423939961295198,
# 0.469716691963537,0.332541567695962,0.28658360163997,0.26132749555266,0.401100160440064,0.367724311830216,
# 0.437263270255877,0.364583333333333,0.365955667084902,0.35,0.346637615133208,0.332383665716999,0.395180722891566,
# 9.9576071596797,0.429229480737018,0.675290059887006,0.466478628769798,0.48780487804878,0.395939086294416,
# 0.410298492153041,0.441715147597501,0.546448087431694,0.588235294117647,0.547891595734273,0.46200808514149,
# 0.516939085296931,0.520688052068805,0.549635445877734,0.467391304347826,0.453060794436835,0.466175195143105,
# 0.511813698447893,0.509435881057269,0.48914173989071,0.532687935753874,0.573665665517241,0.544662309368192,
# 0.547284445188658,0.563976031018682,0.54354247902635,0.542133176193282,0.550898203592814,0.569306930693069,
# 0.578398088771533,0.625509926570574]

# HGBS11
# percentYield = [0.674168798149954,0.621513878975389,0.552426076988955,0.581296853531296,0.582954809250867,
# 0.574850804167315,0.584160418286167,0.563636363636364,0.516666666666667,0.407497962510187,0.447048611111111,
# 0.490405117270789,0.488007222506893,0.506542845082313,0.503355704697987,0.491803278688525,0.525164113785558,
# 0.587084148727984,0.577918488366249,0.580221997981836,0.568631329113924,0.538868844009184,0.609893833295686,
# 0.638655462184874,0.587002096436059,0.560224089635854,0.551615445232467,0.547516621040282,0.538482249317281,
# 0.775524448408236,0.557991231566361,0.549041138868191,0.549666274047899,0.50179211469534,0.487821875326666,
# 0.466682222740758,0.484094052558783,0.498220640569395,0.410958904109589,0.165094339622642,0.172498767865944,
# 0.163170163170163,0.123213405618531,0.117924528301887,0.142011834319527,0.192400192400192,0.286806883365201,
# 0.305371766992088,0.369788296200425,0.381133873272987,0.197044334975369,0.196174595389897,0.174607133948616,
# 0.248373155829318,0.326633165829146,0.398321737744968]

# HGLG11
# percentYield = [0.771026938929025,0.679531469885882,0.722034336531203,0.694914165030133,0.695050416579739,
# 0.702365020380505,0.700207019735397,0.695443645083933,0.667014229636899,0.678098207326578,0.657596371882086,
# 0.647803425167535,0.662100456621004,0.63043935100979,0.578545921251255,0.617371558330968,0.644444444444444,
# 0.596184419713832,0.595947556615018,0.595143627995556,0.595238095238095,0.572388002747462,0.548205540530663,
# 0.535714285714286,0.51549934703416,0.492449113591595,0.464684014869888,0.476190476190476,0.484496124031008,
# 0.504914501144473,0.469189865498905,0.490934083916999,0.506493506493506,0.480917442505703,0.42963370972184,
# 0.378365268008731,0.407310704960835,0.4405784003615,0.493514710534641,0.450867052023121,0.428689200329761,
# 0.410655996630515,0.433333333333333,0.428571428571429,0.352961938937585,0.475609756097561,0.465116279069767,
# 1.45303867403315,0.434177567492346,0.435754189944134,0.44320700039775,0.448275862068966,0.589831308245842,
# 1.30486358244365,0.651003136651477,0.675634174804987]

# HGRE11
# percentYield = [0.784046635615315,0.727542956350882,0.6839832340149,0.698607571284345,0.680487718548804,
# 0.641872888729889,0.653012943682592,0.638586956521739,0.594936708860759,0.592312539382483,0.620871862615588,
# 0.652777777777778,0.533351111703723,0.533333333333333,0.524590163934426,0.527739296787387,0.581818181818182,
# 0.662251655629139,0.657084188911704,0.642570281124498,0.489808816558698,0.549165120593692,0.513888888888889,
# 0.49548041513224,0.509922822491731,0.493432019737281,0.486842105263158,0.471397630271372,0.470139771283354,
# 0.461059190031153,0.446590223295112,0.491694352159468,0.463949843260188,0.426512968299712,0.44047619047619,
# 0.545454545454545,0.373699626300374,0.41845736258765,0.42483660130719,0.390143737166324,0.394490968233096,
# 0.378989361702128,0.464285714285714,0.442598393027373,0.433333333333333,0.429780481354139,0.433825001668558,
# 0.617834394904459,0.446666666666667,0.452733292790053,0.486211901306241,0.486317776003484,0.536297217472408,
# 1.03876552502823,0.491103202846975,0.518524085068009]

# KNRI11
# percentYield = [0.61773596215125,0.624353437162403,0.602954500162622,0.613528647234325,0.619456613073752,
# 0.615285675723641,0.615820582817961,0.607260726072607,0.54421768707483,0.542772861356932,0.547619047619048,
# 0.559270516717325,0.382716049382716,0.488676996424315,0.467769537934969,0.491017964071856,0.51931602279924,
# 0.645659344515405,0.553567812056977,0.588235294117647,0.602941176470588,0.534201954397394,0.487162606978275,
# 0.50608671864314,0.492676431424767,0.484610347085789,0.485118657401337,0.486266263635169,0.47741935483871,
# 0.479802891784996,0.482116098768649,0.467762326169406,0.461922596754057,0.435294117647059,0.423098913664951,
# 0.373397921081845,0.407399251266241,0.432875109681193,0.422023113881314,0.408830744071954,0.377052033180579,
# 0.384751982952528,0.414487947965821,0.395401180120445,0.393867781615464,0.40950040950041,0.408163265306122,
# 0.400443568260227,0.431789737171464,0.435908775033167,0.451777646827735,0.462621521957761,0.480100194823267,
# 0.497799581559772,0.491558025219064,0.513469789688401]

# MXRF11
# percentYield = [0.886482738977752,0.870962147326792,0.942691232378302,0.985136857716693,1.026694045,
# 0.608090795777052,0.735497122592585,0.639658848614072,0.72992700729927,0.623700623700624,0.613496932515337,
# 0.525762355415352,0.625651720542232,0.730688935281837,0.578034682080925,0.551470588235294,0.824742268041237,
# 1.03092783505155,0.794438927507448,0.688298918387414,0.714285714285714,0.593471810089021,0.589390962671906,
# 0.5859375,0.533333333333333,0.631768953068592,0.602928509905254,0.619469026548673,0.599315068493151,
# 0.613496932515338,0.585284280936455,0.642201834862385,0.799289520426288,0.803571428571429,0.784655623365301,
# 0.920679886685552,0.684931506849315,0.803571428571429,0.78740157480315,0.69101678183613,0.646352723915051,
# 0.636942675159236,0.639269406392694,0.656044985941893,0.641613198900092,0.576368876080692,0.56710775047259,
# 0.667302192564347,0.753295668549906,0.740740740740741,0.769230769230769,0.75046904315197,0.662251655629139,
# 0.689655172413793,0.684261974584555,0.801603206412826]

# VRTA11
# percentYield = [0.943802340106589,0.825516374993312,0.830848017050626,0.86062741459779,0.869983152020773,
# 0.837469885210968,0.714008802145779,0.690265486725664,0.631142367685511,0.667284522706209,0.66106336764567,
# 0.630630630630631,0.632168337397273,0.579493410599121,0.648801128349788,0.691912108461898,0.69811320754717,
# 0.758426966292135,0.808042845062482,0.90032154340836,0.902394106813996,1.02222222222222,0.907488986784141,
# 0.845188284518828,0.820661356504948,0.768752911942848,0.685131195335277,0.791208791208791,0.74147305981216,
# 0.686683721556483,0.611223096430197,0.63150074294205,0.581967213114754,0.566973777462792,0.494590417310665,
# 0.538461538461538,0.590909090909091,0.648,0.702087286527514,0.628708049234039,0.650044523597507,0.880814753647124,
# 0.544594232657798,0.485714285714286,0.585131894484412,0.632305039279556,0.716878402903811,0.765957446808511,
# 0.777000777000777,0.788493198163071,0.782608695652174,0.777941049356038,0.925102294965309,0.930656934306569,
# 0.947070277925297,0.944094779711218]

# BBPO11
# percentYield = [0.742153992023615,0.715730444499482,0.70547592715277,0.708709465934981,0.705210478914282,
# 0.704802550350149,0.715275161982014,0.700659928571429,0.634902200647249,0.636963571428571,0.660332480646247,
# 0.868697152777778,0.683475404124861,0.66843195911414,0.656575568942436,0.661668735244519,0.705142620947452,
# 0.784801904152332,0.748796870229008,0.808129080586658,0.808894475138122,0.742658913043478,0.735675328404278,
# 0.73267750929368,0.732101792985213,0.737316043165468,0.731109502068769,0.725571185840708,0.717695588235294,
# 0.701965273972603,0.685439606741573,0.700544732136945,0.700683931646576,0.6838349062702,0.661637750953781,
# 0.616487529137529,0.644624093595759,0.655082419964084,0.762610005767013,0.695478666754322,0.671251649746193,
# 0.645056463414634,0.762664984500036,0.777256660682226,0.781465631768953,0.780507607990193,0.792915677655678,
# 0.873339707899621,0.941156434782609,0.954435537918871,0.932239362618432,0.930796267629859,0.937894194107452,
# 0.940257058465815,0.937975474477858,0.711496746203905]

# MFII11
percentYield = [1.11984451629976, 1.11583732742624, 1.1137868177984, 1.07599758350498, 1.03538668683051,
                0.997985560290547, 0.960585330484414, 1.01739130434783, 0.970954356846473, 0.89041095890411,
                0.858652575957728, 0.836969740324773, 0.826793721973094, 0.975126022642757, 0.887218045112782,
                0.890700483091788, 0.982514571190675, 1.01724137931034, 0.0, 0.0, 0.0, 1.35714285714286,
                1.14720812182741, 1.21492312654553, 1.16, 1.06323964497041, 1.03603603603604, 1.03603603603604,
                1.02222222222222, 0.92485549132948, 0.927217526872897, 0.905280804694049, 0.869208692086921,
                0.795338215607528, 0.789328281632331, 0.757805395574416, 0.730406836607991, 0.795631825273011,
                0.990384615384615, 0.903508771929825, 0.815963806753918, 0.758785942492013, 0.780487804878049,
                0.776237623762376, 0.779983010271063, 0.833270206802515, 0.785714285714286, 0.764144011756062,
                0.75774626753695, 0.773176146367603, 0.802382331044751, 0.751010976314269, 0.790342192113948,
                0.856610800744879, 1.01703534197813, 1.03794156127344]

monthAux = []
monthDate = []

for i in range(month.__len__()):
    monthAux.append(pd.to_datetime(month[i], format='%d/%m/%Y'))

for i in range(monthAux.__len__()):
    monthDate.append(monthAux[i].date())

name = "MFII11"

criarTabelaDividendo(name)

for num in range(monthAux.__len__()):
    mes = monthDate[num]
    yieldMonth = percentYield[num]

    cursor.execute('INSERT into dividend.' + name + ' (mes, yield) VALUES(%s,%s)', (mes, yieldMonth))
    database.commit()
